<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Love Chat AI</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #f7d7e8;
    margin: 0;
    padding: 0;
}
#chat-box {
    width: 90%;
    max-width: 600px;
    margin: 40px auto;
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 10px #0002;
    height: 400px;
    overflow-y: auto;
}
.message {
    margin: 10px 0;
    padding: 10px;
    border-radius: 8px;
    word-wrap: break-word;
}
.user {
    background: #ffeff8;
    text-align: right;
}
.bot {
    background: #e8f4ff;
}
#lock-message {
    display: none;
    text-align: center;
    padding: 20px;
    background: #ffe6e6;
    margin-top: 10px;
    border-radius: 10px;
}
input, button {
    width: 100%;
    padding: 12px;
    margin-top: 10px;
    border-radius: 6px;
    border: 1px solid #aaa;
}
button {
    background: #ff4fa1;
    color: white;
    font-weight: bold;
    cursor: pointer;
}
</style>
</head>
<body>

<div id="chat-box"></div>

<div id="lock-message">
    <h3>Youâ€™ve reached your free limit.</h3>
    <p>Watch an ad to continue chatting.</p>
    <button id="watch-ad-btn">Watch Ad</button>
</div>

<input id="chat-input" type="text" placeholder="Type your messageâ€¦">
<button id="send-btn">Send</button>

<script>
// ----------------- MESSAGE LIMIT -----------------
let messageCount = parseInt(localStorage.getItem("msg_count")) || 0;
const MSG_LIMIT = 3;

function checkLimit() {
    if (messageCount >= MSG_LIMIT) {
        lockChat();
        return false;
    }
    return true;
}

function registerMessage() {
    messageCount++;
    localStorage.setItem("msg_count", messageCount);
    if (messageCount >= MSG_LIMIT) {
        lockChat();
    }
}

function lockChat() {
    document.getElementById("chat-input").disabled = true;
    document.getElementById("send-btn").disabled = true;
    document.getElementById("lock-message").style.display = "block";
}

function unlockChat() {
    messageCount = 0;
    localStorage.setItem("msg_count", 0);
    document.getElementById("chat-input").disabled = false;
    document.getElementById("send-btn").disabled = false;
    document.getElementById("lock-message").style.display = "none";
}

// ----------------- MONEYTAG AD -----------------
function openMoneyTagAd() {
    const adLink = "https://otieu.com/4/10223438";
    window.open(adLink, "_blank"); // opens in new tab
    // unlock after 3 seconds
    setTimeout(() => {
        alert("Chat unlocked! Thank you for watching the ad.");
        unlockChat();
    }, 3000);
}

document.getElementById("watch-ad-btn").addEventListener("click", openMoneyTagAd);

// ----------------- CHATBOT -----------------
async function sendMessage() {
    if (!checkLimit()) return;

    const userInput = document.getElementById("chat-input").value.trim();
    if (userInput === "") return;

    addMessage(userInput, "user");
    registerMessage();
    document.getElementById("chat-input").value = "";

    // ----- AI RESPONSE -----
    const botReply = await getBotReply(userInput);
    addMessage(botReply, "bot");
}

// Replace YOUR_OPENAI_API_KEY_HERE with your OpenAI API key
async function getBotReply(userText) {
    const apiKey = "sk-...DPsA"; // ðŸ”‘ unsafe in browser
    try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + apiKey
            },
            body: JSON.stringify({
                model: "gpt-3.5-turbo",
                messages: [{ role: "user", content: userText }]
            })
        });
        const data = await response.json();
        return data.choices[0].message.content;
    } catch (error) {
        console.error(error);
        return "Sorry, AI is not responding right now.";
    }
}

function addMessage(text, role) {
    const box = document.getElementById("chat-box");
    const div = document.createElement("div");
    div.className = "message " + role;
    div.textContent = text;
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
}

// Button click
document.getElementById("send-btn").addEventListener("click", sendMessage);

// Press Enter to send
document.getElementById("chat-input").addEventListener("keypress", function(e) {
    if (e.key === "Enter") sendMessage();
});
</script>

</body>
</html>
